[
  {
    "id": "compatibility_basis",
    "input": "What determines whether a dyno can handle a vehicle?",
    "expected": [
      "supported_weight_classes",
      "supported_drives",
      "supported_test_types",
      "compatibility comes from database fields rather than hardcoded rules"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "availability_query",
    "input": "How do you check which dynos are free for an AWD 4800 lb brake test next week?",
    "expected": [
      "find_available_dynos",
      "requires start_date and end_date",
      "filters out overlapping allocations where status != 'cancelled'",
      "respects dyno.enabled and available_from/available_to"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "weight_thresholds",
    "input": "How are weight limits handled?",
    "expected": [
      "weight_lbs is converted to <10K or >10K",
      "matching uses supported_weight_classes in the DB"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "drive_type_override",
    "input": "Can we force an AWD vehicle onto a dyno that only supports 2WD?",
    "expected": [
      "request should be refused if supported_drives lacks AWD",
      "no manual override of drive compatibility"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "maintenance_policy",
    "input": "How do we see which dynos are down for maintenance today?",
    "expected": [
      "maintenance_check_core",
      "enabled dynos with available_from in the future or available_to in the past are reported"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "conflict_detection_logic",
    "input": "How are scheduling conflicts detected?",
    "expected": [
      "detect_conflicts_core",
      "self-join on the same dyno to find overlapping start and end dates",
      "ignores allocations with status 'cancelled'"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "auto_allocate_flow",
    "input": "How does auto allocation work when I provide a vehicle id and a start date?",
    "expected": [
      "resolves vehicle by id or vin",
      "uses vehicle weight_lbs and drive_type with test_type defaulting to brake",
      "checks for existing overlapping allocations for the vehicle first",
      "tries requested window then backup windows up to max_backup_days",
      "locks dyno rows with SELECT ... FOR UPDATE before creating an allocation"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "existing_vehicle_guard",
    "input": "What happens if a vehicle is already allocated during those dates?",
    "expected": [
      "VehicleAlreadyAllocatedError",
      "overlapping allocations for the same vehicle are rejected unless cancelled"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "query_database_rules",
    "input": "What SQL can I run through the agent?",
    "expected": [
      "query_database only allows SELECT",
      "DROP, DELETE, UPDATE, INSERT, ALTER are blocked",
      "statement_timeout of 2000ms is set",
      "avoid SELECTs without a WHERE clause"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "completed_tests_metric",
    "input": "How do you count completed tests?",
    "expected": [
      "completed_tests_count_core",
      "counts allocations where status is 'completed'"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "check_vehicle_allocations",
    "input": "How can I see where a vehicle is already scheduled?",
    "expected": [
      "check_vehicle_allocation_core",
      "joins dyno names and allocation dates for the vehicle"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "backup_window_limit",
    "input": "When backup scheduling is on, how far ahead will it search?",
    "expected": [
      "backup windows iterate up to max_backup_days",
      "default max_backup_days is 7 if not overridden"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
  },
  {
    "id": "check_vehicle_allocations_nonexistent",
    "input": "How can I see the schedule for a vehicle that does not exist?",
    "expected": [
        "vehicle not found",
        "does not exist"
    ],
    "must_not_contain": ["guess", "hallucinate", "not sure"]
    }
]
